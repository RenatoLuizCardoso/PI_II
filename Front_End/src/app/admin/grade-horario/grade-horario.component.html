<app-navbar></app-navbar>
<div *ngIf="loading">Carregando...</div>

<div *ngIf="!loading">
  <h1>Gerenciar Reservas</h1>

  <!-- Formulário para criar/editar reservas -->
  <!-- Formulário para criar/editar reservas -->
  <form (submit)="isEditing ? updateReservation() : createReservation()">
    <label>
      <strong>Professor:</strong>
       <select [(ngModel)]="form.teacher" name="teacher" required>
    <option *ngFor="let teacher of teachers" [value]="teacher.teacherId">
      {{ teacher.teacherName }}
    </option>
  </select>
    </label>
    <label>
      <strong>Disciplina:</strong>
      <select [(ngModel)]="form.subject" name="subject" (change)="logSelectedValue('Disciplina', form.subject)" required>
        <option *ngFor="let subject of subjects" [value]="subject.subjectId">
          {{ subject.subjectName }}
        </option>
      </select>
    </label>
    <label>
      <strong>Horário:</strong>
      <select [(ngModel)]="form.time" name="time" (change)="logSelectedValue('Horário', form.time)" required>
        <option *ngFor="let time of times" [value]="time.timeId">
          {{ time.startTime }}-{{ time.endTime }}
        </option>
      </select>
    </label>
    <label>
      <strong>Sala:</strong>
      <select [(ngModel)]="form.room" name="room" (change)="logSelectedValue('Sala', form.room)" required>
        <option *ngFor="let room of rooms" [value]="room.roomId">
          {{ room.roomType }} {{ room.roomFloor }}
        </option>
      </select>
    </label>
    <label>
      <strong>Curso:</strong>
      <select [(ngModel)]="form.course" name="course" (change)="logSelectedValue('Curso', form.course)" required>
        <option *ngFor="let course of courses" [value]="course.courseId">
          {{ course.courseName }}
        </option>
      </select>
    </label>
    <label>
      <strong>Data:</strong>
      <input [(ngModel)]="form.date" name="date" type="date" required />
    </label>
    <button type="submit">{{ isEditing ? 'Atualizar' : 'Adicionar' }}</button>
    <button type="button" (click)="cancel()">Cancelar</button>
  </form>


  <table border="1" style="width: 100%; text-align: center; margin-top: 20px;">
    <thead>
      <tr>
        <th>ID</th>
        <th>Professor</th>
        <th>Disciplina</th>
        <th>Horário</th>
        <th>Data</th>
        <th>Sala</th>
        <th>Curso</th>
        <th>Ações</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let reservation of reservations">
        <td>{{ reservation.reservationId }}</td>
        <td>{{ reservation.teacher }}</td>
        <td>{{ reservation.subject }}</td>
        <td>{{ reservation.time }}</td>
        <td>{{ reservation.date }}</td>
        <td>{{ reservation.room }}</td>
        <td>{{ reservation.course }}</td>
        <td>
          <button (click)="editReservation(reservation)">Editar</button>
          <button (click)="deleteReservation(reservation.reservationId)">Excluir</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
